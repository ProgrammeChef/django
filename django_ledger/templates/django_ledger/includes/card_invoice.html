{% load django_ledger %}
{% load i18n %}

{% if not create_invoice %}
    <div class="card">
        <div class="card-content">
            <p class="subtitle has-text-grey has-text-right">
                <span class="icon">{% icon "bi:cash-stack" 16 %}</span>
                {% trans 'Invoice' %}</p>
            <p class="title">{{ invoice.customer.customer_name }}</p>
            <p class="subtitle has-text-weight-light">{{ invoice.customer.address_1 }}</p>
            {% if not invoice.is_past_due %}
                <p class="is-size-5 has-text-info">Due in: {{ invoice.due_date | timeuntil }}</p>
            {% else %}
                <p class="has-text-danger has-text-weight-bold is-size-5">Past
                    Due: {{ invoice.due_date | timesince }} ago</p>
            {% endif %}
            {% if invoice.progressible %}
                <p>Is Progressible: <span class="icon has-text-success"><i
                        class="mdi mdi-18px mdi-check-circle"></i></span></p>
            {% else %}
                <p>Is Progressible: <span class="icon has-text-danger"><i
                        class="mdi mdi-18px mdi-do-not-disturb"></i></span>
                </p>
            {% endif %}
            <p class="is-size-5 has-text-success">Owed to You: ${{ invoice.get_amount_open | cs_thousands }}</p>
            <p>Amount Paid: ${{ invoice.amount_paid | cs_thousands }}</p>
            <p>Progressed: {{ invoice.get_progress | percentage }}</p><br>
            <progress class="progress is-medium is-success"
                      value="{{ invoice.get_progress_percent }}"
                      max="100">{{ invoice.get_progress | percentage }}
            </progress>

            {# MARK AS PAID MODAL #}
            {% mark_as_paid invoice %}

        </div>

        <footer class="card-footer">
            <a href="{% url 'django_ledger:invoice-update' entity_slug=entity_slug invoice_pk=invoice.uuid %}"
               class="card-footer-item has-text-primary has-text-centered">{% trans 'Details' %}</a>
            <a onclick="djLedger.toggleModal('{{ invoice.get_html_id }}')"
               class="card-footer-item has-text-info has-text-centered">{% trans 'Mark as Paid' %}</a>
            <a href="{% url 'django_ledger:invoice-delete' entity_slug=entity_slug invoice_pk=invoice.uuid %}"
               class="card-footer-item has-text-danger has-text-centered">{% trans 'Delete' %}</a>
        </footer>
    </div>
{% else %}
    <div class="box has-text-centered">
        <a href="{% url 'django_ledger:invoice-create' entity_slug=entity_slug %}">
            <span class="icon is-large has-text-grey">{% icon "ic:baseline-add-circle-outline" 48 %}</span></a>
        <h2 class="is-size-3 has-text-grey">{% trans 'New Invoice' %}</h2>
    </div>
{% endif %}

